apiVersion: v1
data:
  dashboards.yaml: |-
    apiVersion: 1
    providers:
      - name: 'default'
        orgId: 1
        folder: ''
        type: file
        disableDeletion: false
        updateIntervalSeconds: 10
        options:
          path: /etc/grafana/provisioning/dashboards
  performance_overview.json: |
    {
       "__inputs": [ ],
       "__requires": [ ],
       "annotations": {
          "list": [ ]
       },
       "description": "performance overview in development environment",
       "editable": true,
       "gnetId": null,
       "graphTooltip": 1,
       "hideControls": false,
       "id": null,
       "links": [
          {
             "asDropdown": true,
             "icon": "external link",
             "includeVars": false,
             "keepTime": true,
             "tags": [
                "vitess-mixin"
             ],
             "targetBlank": false,
             "title": "vitess-mixin",
             "type": "dashboards",
             "url": ""
          }
       ],
       "panels": [
          {
             "collapse": false,
             "collapsed": false,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 0
             },
             "id": 2,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Summary",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "cacheTimeout": null,
             "colorBackground": false,
             "colorValue": false,
             "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
             ],
             "datasource": "Prometheus",
             "format": "short",
             "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
             },
             "gridPos": {
                "h": 4,
                "w": 4,
                "x": 0,
                "y": 1
             },
             "id": 3,
             "interval": null,
             "links": [ ],
             "mappingType": 1,
             "mappingTypes": [
                {
                   "name": "value to text",
                   "value": 1
                },
                {
                   "name": "range to text",
                   "value": 2
                }
             ],
             "maxDataPoints": 100,
             "nullPointMode": "connected",
             "nullText": null,
             "postfix": "",
             "postfixFontSize": "50%",
             "prefix": "",
             "prefixFontSize": "50%",
             "rangeMaps": [
                {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                }
             ],
             "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "rgb(31, 120, 193)",
                "show": true
             },
             "tableColumn": "",
             "targets": [
                {
                   "expr": "sum (\n  vitess_mixin:vtgate_api_count:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "",
                   "refId": "A"
                }
             ],
             "thresholds": "",
             "title": "QPS - vtgate",
             "type": "singlestat",
             "valueFontSize": "70%",
             "valueMaps": [
                {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                }
             ],
             "valueName": "current"
          },
          {
             "cacheTimeout": null,
             "colorBackground": true,
             "colorValue": false,
             "colors": [
                "#d44a3a",
                "rgba(237, 129, 40, 0.89)",
                "#299c46"
             ],
             "datasource": "Prometheus",
             "decimals": 4,
             "format": "percent",
             "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
             },
             "gridPos": {
                "h": 4,
                "w": 4,
                "x": 4,
                "y": 1
             },
             "id": 4,
             "interval": null,
             "links": [ ],
             "mappingType": 1,
             "mappingTypes": [
                {
                   "name": "value to text",
                   "value": 1
                },
                {
                   "name": "range to text",
                   "value": 2
                }
             ],
             "maxDataPoints": 100,
             "nullPointMode": "connected",
             "nullText": null,
             "postfix": "",
             "postfixFontSize": "50%",
             "prefix": "",
             "prefixFontSize": "50%",
             "rangeMaps": [
                {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                }
             ],
             "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
             },
             "tableColumn": "",
             "targets": [
                {
                   "expr": "100 \n-\nsum(\n  rate(\n    vtgate_api_error_counts{\n      job=\"vitess-vtgate\"\n    }[$interval]\n  ) OR vector(0)\n)\n/\nsum(\n  rate(\n    vtgate_api_count{\n      job=\"vitess-vtgate\"\n    }[$interval]\n  )\n)\n",
                   "format": "time_series",
                   "instant": true,
                   "intervalFactor": 1,
                   "legendFormat": "",
                   "refId": "A"
                }
             ],
             "thresholds": "0.99,0.999",
             "title": "Query success - vtgate",
             "type": "singlestat",
             "valueFontSize": "70%",
             "valueMaps": [
                {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                }
             ],
             "valueName": "current"
          },
          {
             "cacheTimeout": null,
             "colorBackground": true,
             "colorValue": false,
             "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
             ],
             "datasource": "Prometheus",
             "decimals": 2,
             "format": "ms",
             "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
             },
             "gridPos": {
                "h": 4,
                "w": 4,
                "x": 8,
                "y": 1
             },
             "id": 5,
             "interval": null,
             "links": [ ],
             "mappingType": 1,
             "mappingTypes": [
                {
                   "name": "value to text",
                   "value": 1
                },
                {
                   "name": "range to text",
                   "value": 2
                }
             ],
             "maxDataPoints": 100,
             "nullPointMode": "connected",
             "nullText": null,
             "postfix": "",
             "postfixFontSize": "50%",
             "prefix": "",
             "prefixFontSize": "50%",
             "rangeMaps": [
                {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                }
             ],
             "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "rgb(31, 120, 193)",
                "show": false
             },
             "tableColumn": "",
             "targets": [
                {
                   "expr": "1000 * histogram_quantile(\n  0.99,\n  sum by(le)(\n    vitess_mixin:vtgate_api_bucket:rate1m\n  )\n)\n",
                   "format": "time_series",
                   "instant": true,
                   "intervalFactor": 1,
                   "legendFormat": "",
                   "refId": "A"
                }
             ],
             "thresholds": "30,50",
             "title": "Query latency p99",
             "type": "singlestat",
             "valueFontSize": "70%",
             "valueMaps": [
                {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                }
             ],
             "valueName": "current"
          },
          {
             "cacheTimeout": null,
             "colorBackground": false,
             "colorValue": false,
             "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
             ],
             "datasource": "Prometheus",
             "format": "short",
             "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
             },
             "gridPos": {
                "h": 4,
                "w": 3,
                "x": 12,
                "y": 1
             },
             "id": 6,
             "interval": null,
             "links": [ ],
             "mappingType": 1,
             "mappingTypes": [
                {
                   "name": "value to text",
                   "value": 1
                },
                {
                   "name": "range to text",
                   "value": 2
                }
             ],
             "maxDataPoints": 100,
             "nullPointMode": "connected",
             "nullText": null,
             "postfix": "",
             "postfixFontSize": "50%",
             "prefix": "",
             "prefixFontSize": "50%",
             "rangeMaps": [
                {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                }
             ],
             "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "rgb(31, 120, 193)",
                "show": true
             },
             "tableColumn": "",
             "targets": [
                {
                   "expr": "round(sum(vttablet_queries_count{plan_type=~\"Select|SelectImpossible|OtherRead|Show\"})\n    /\nsum(vttablet_queries_count{plan_type=~\"Select|SelectImpossible|OtherRead|Show|Insert|Update|Delete\"}) * 100, 0.1)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "",
                   "refId": "A"
                }
             ],
             "thresholds": "",
             "title": "Read Ratio",
             "type": "singlestat",
             "valueFontSize": "70%",
             "valueMaps": [
                {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                }
             ],
             "valueName": "current"
          },
          {
             "cacheTimeout": null,
             "colorBackground": false,
             "colorValue": false,
             "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
             ],
             "datasource": "Prometheus",
             "format": "short",
             "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
             },
             "gridPos": {
                "h": 4,
                "w": 3,
                "x": 15,
                "y": 1
             },
             "id": 7,
             "interval": null,
             "links": [ ],
             "mappingType": 1,
             "mappingTypes": [
                {
                   "name": "value to text",
                   "value": 1
                },
                {
                   "name": "range to text",
                   "value": 2
                }
             ],
             "maxDataPoints": 100,
             "nullPointMode": "connected",
             "nullText": null,
             "postfix": "",
             "postfixFontSize": "50%",
             "prefix": "",
             "prefixFontSize": "50%",
             "rangeMaps": [
                {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                }
             ],
             "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "rgb(31, 120, 193)",
                "show": true
             },
             "tableColumn": "",
             "targets": [
                {
                   "expr": "round(sum(vttablet_queries_count{plan_type=~\"Insert|Update|Delete\"})\n    /\nsum(vttablet_queries_count{plan_type=~\"Select|SelectImpossible|OtherRead|Show|Insert|Update|Delete\"}) * 100, 0.1)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "",
                   "refId": "A"
                }
             ],
             "thresholds": "",
             "title": "Write Ratio",
             "type": "singlestat",
             "valueFontSize": "70%",
             "valueMaps": [
                {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                }
             ],
             "valueName": "current"
          },
          {
             "cacheTimeout": null,
             "colorBackground": false,
             "colorValue": false,
             "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
             ],
             "datasource": "Prometheus",
             "format": "short",
             "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
             },
             "gridPos": {
                "h": 4,
                "w": 3,
                "x": 18,
                "y": 1
             },
             "id": 8,
             "interval": null,
             "links": [ ],
             "mappingType": 1,
             "mappingTypes": [
                {
                   "name": "value to text",
                   "value": 1
                },
                {
                   "name": "range to text",
                   "value": 2
                }
             ],
             "maxDataPoints": 100,
             "nullPointMode": "connected",
             "nullText": null,
             "postfix": "",
             "postfixFontSize": "50%",
             "prefix": "",
             "prefixFontSize": "50%",
             "rangeMaps": [
                {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                }
             ],
             "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "rgb(31, 120, 193)",
                "show": true
             },
             "tableColumn": "",
             "targets": [
                {
                   "expr": "sum (\n  vitess_mixin:vttablet_connections_in_use:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "",
                   "refId": "A"
                }
             ],
             "thresholds": "",
             "title": "Connections In Use - vttablet",
             "type": "singlestat",
             "valueFontSize": "70%",
             "valueMaps": [
                {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                }
             ],
             "valueName": "current"
          },
          {
             "cacheTimeout": null,
             "colorBackground": false,
             "colorValue": false,
             "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
             ],
             "datasource": "Prometheus",
             "format": "short",
             "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
             },
             "gridPos": {
                "h": 4,
                "w": 3,
                "x": 21,
                "y": 1
             },
             "id": 9,
             "interval": null,
             "links": [ ],
             "mappingType": 1,
             "mappingTypes": [
                {
                   "name": "value to text",
                   "value": 1
                },
                {
                   "name": "range to text",
                   "value": 2
                }
             ],
             "maxDataPoints": 100,
             "nullPointMode": "connected",
             "nullText": null,
             "postfix": "",
             "postfixFontSize": "50%",
             "prefix": "",
             "prefixFontSize": "50%",
             "rangeMaps": [
                {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                }
             ],
             "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "rgb(31, 120, 193)",
                "show": true
             },
             "tableColumn": "",
             "targets": [
                {
                   "expr": "sum (\n  vitess_mixin:vttablet_connections_active:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "",
                   "refId": "A"
                }
             ],
             "thresholds": "",
             "title": "Connections Established - vttablet",
             "type": "singlestat",
             "valueFontSize": "70%",
             "valueMaps": [
                {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                }
             ],
             "valueName": "current"
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 5
             },
             "id": 10,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Requests (VTGate)",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 6
             },
             "id": 11,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  rate(\n    vtgate_api_count{\n      instance=~'$vtgate_host'\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Requests",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 6
             },
             "id": 12,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (db_type)(\n  vitess_mixin:vtgate_api_count_by_db_type:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{db_type}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Requests (by tablet_type)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 6
             },
             "id": 13,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(keyspace)(\n  vitess_mixin:vtgate_api_count_by_keyspace:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{keyspace}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Requests (by keyspace)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 13
             },
             "id": 14,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Requests (VTTablet)",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 14
             },
             "id": 15,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum  by (instance)(\n  rate(\n    vttablet_query_counts{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Requests",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 14
             },
             "id": 16,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance, plan_type)(\n  rate(\n    vttablet_queries_count{\n      instance=~\"$host\"\n    } [1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}} | {{plan_type}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Requests (by plan type)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 14
             },
             "id": 17,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (table)(\n  vitess_mixin:vttablet_query_counts_by_keyspace_table:rate1m{\n    table=~\"$table\"\n  }\n)\nor\nvector(0)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{table}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Requests (by table)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "rps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": false,
             "collapsed": false,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 21
             },
             "id": 18,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Duration",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": {
                "Duration": "#5794F2"
             },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 22
             },
             "id": 19,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum (\n  rate(\n    vtgate_api_sum[5m]\n  )\n)\n/\nsum (\n  rate(\n    vtgate_api_count[5m]\n    )\n  )\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Avg Latency (vtgate)",
                   "refId": "A"
                },
                {
                   "expr": "sum (\n  rate(\n    vttablet_queries_sum[5m]\n  )\n)\n/\nsum (\n  rate(\n    vttablet_queries_count[5m]\n    )\n  )\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Avg Latency (vttablet)",
                   "refId": "B"
                },
                {
                   "expr": "sum (\n  rate(\n    vttablet_mysql_sum[5m]\n  )\n)\n/\nsum (\n  rate(\n    vttablet_mysql_count[5m]\n    )\n  )\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Avg Latency (mysql)",
                   "refId": "C"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Duration (Avg)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": {
                "Duration": "#5794F2"
             },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 22
             },
             "id": 20,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "histogram_quantile(\n  0.50,\n  sum by(le)(\n    vitess_mixin:vtgate_api_bucket:rate1m\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Duration p50 (vtgate)",
                   "refId": "A"
                },
                {
                   "expr": "histogram_quantile(\n  0.50,\n  sum by(le)(\n    vitess_mixin:vttablet_queries_bucket:rate1m\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Duration p50 (vttablet)",
                   "refId": "B"
                },
                {
                   "expr": "histogram_quantile(\n  0.50,\n  sum by(le)(\n    vitess_mixin:vttablet_mysql_bucket:rate1m\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Duration p50 (mysql)",
                   "refId": "C"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Duration 50th quantile",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": {
                "Duration": "#5794F2"
             },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 22
             },
             "id": 21,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "histogram_quantile(\n  0.95,\n  sum by(le)(\n    vitess_mixin:vtgate_api_bucket:rate1m\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Duration p95 (vtgate)",
                   "refId": "A"
                },
                {
                   "expr": "histogram_quantile(\n  0.95,\n  sum by(le)(\n    vitess_mixin:vttablet_queries_bucket:rate1m\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Duration p95 (vttablet)",
                   "refId": "B"
                },
                {
                   "expr": "histogram_quantile(\n  0.95,\n  sum by(le)(\n    vitess_mixin:vttablet_mysql_bucket:rate1m\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "Duration p95 (mysql)",
                   "refId": "C"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Duration 95th quantile",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 29
             },
             "id": 22,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Duration (VTTablet Transaction)",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 30
             },
             "id": 23,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "max",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance)(\n  rate(\n    vttablet_transactions_sum{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n/\nsum by(instance)(\n  rate(\n    vttablet_transactions_count{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Transaction Duration (avg)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 30
             },
             "id": 24,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "max",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "histogram_quantile(\n  0.50,sum by(instance,le)(\n    rate(\n      vttablet_transactions_bucket{\n        instance=~\"$host\"\n      }[1m]\n    )\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Transaction Duration (p50)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 30
             },
             "id": 25,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "max",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "histogram_quantile(\n  0.95,sum by(instance,le)(\n    rate(\n      vttablet_transactions_bucket{\n        instance=~\"$host\"\n      }[1m]\n    )\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Transaction Duration (p95)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 37
             },
             "id": 26,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Errors (VTGate)",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 38
             },
             "id": 27,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (code)(\n  vitess_mixin:vtgate_api_error_counts_by_code:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{code}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Errors (by code)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "cps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "cps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 38
             },
             "id": 28,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (operation)(\n  vitess_mixin:vtgate_api_error_counts_by_operation:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{operation}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Errors (by operation)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "cps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "cps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 38
             },
             "id": 29,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (db_type)(\n  vitess_mixin:vtgate_api_error_counts_by_db_type:rate1m\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{db_type}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Errors (by tablet_type)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "cps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "cps",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 45
             },
             "id": 30,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "WeScale - Query pool",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "number of available connections in the pool in real-time",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 46
             },
             "id": 31,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  vttablet_conn_pool_available{\n    instance=~'$host'\n  }\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Available Connections",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "count of in use connections to mysql",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 46
             },
             "id": 32,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance) (\n  vttablet_conn_pool_active{\n    instance=~'$host'\n  }\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Active Connections",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "rate of closing connections due to the idle timeout",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 46
             },
             "id": 33,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  rate(\n    vttablet_conn_pool_idle_closed{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Idle Closed Rate",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "WaitCount will give you how often the transaction pool gets full that causes new transactions to wait.",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 53
             },
             "id": 34,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  rate(\n    vttablet_conn_pool_wait_count{\n      instance=~'$host'\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Wait count",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "WaitTime/WaitCount will tell you the average wait time.",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 53
             },
             "id": 35,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance) (\n  rate(\n    vttablet_conn_pool_wait_time{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n/\nsum by (instance) (\n  rate(\n    vttablet_conn_pool_wait_count{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Avg wait time",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 60
             },
             "id": 36,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "WeScale - Transaction pool",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "number of available connections in the pool",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 61
             },
             "id": 37,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  vttablet_transaction_pool_available{\n    instance=~'$host'\n  }\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Available Connections",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "Number of connections actually open to mysql",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 61
             },
             "id": 38,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance) (\n  vttablet_transaction_pool_active{\n    instance=~'$host'\n  }\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Active Connections",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "Rate of closing connections due to the idle timeout",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 61
             },
             "id": 39,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  rate(\n    vttablet_transaction_pool_idle_closed{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Idle Closed Rate",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "WaitCount will give you how often the transaction pool gets full that causes new transactions to wait.",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 68
             },
             "id": 40,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  rate(\n    vttablet_transaction_pool_wait_count{\n      instance=~'$host'\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Wait count",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "WaitTime/WaitCount will tell you the average wait time.",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 68
             },
             "id": 41,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance) (\n  rate(\n    vttablet_transaction_pool_wait_time{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n/\nsum by (instance) (\n  rate(\n    vttablet_transaction_pool_wait_count{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Avg wait time",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 75
             },
             "id": 42,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Active connections of All Pools",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "Number of active connections in all connection pools",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 76
             },
             "id": 43,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "avg",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance, __name__) (\n  {__name__=~\"vttablet.*active\", instance=~\"$host\"}\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}} - {{__name__}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Active Connections of All Pools",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 83
             },
             "id": 44,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "WeScale Timings",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 84
             },
             "id": 45,
             "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "max",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance)(\n  rate(\n    vtgate_vttablet_call_sum[1m]\n  )\n)\n/\nsum by (instance)(\n  rate(\n    vtgate_vttablet_call_count[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "VtGate -> VtTablet Call Time (avg)",
             "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "cards": {
                "cardPadding": null,
                "cardRound": null
             },
             "color": {
                "cardColor": "#FF9830",
                "colorScale": "sqrt",
                "exponent": 0.29999999999999999,
                "mode": "opacity"
             },
             "dataFormat": "tsbuckets",
             "datasource": "Prometheus",
             "description": "Shows a heatmap of the histogram bucketing of the time per read query.",
             "gridPos": {
                "h": 7,
                "w": 16,
                "x": 8,
                "y": 84
             },
             "heatmap": { },
             "hideZeroBuckets": false,
             "highlightCards": true,
             "id": 46,
             "legend": {
                "show": false
             },
             "targets": [
                {
                   "expr": "sum by (le) (\n  rate(\n    vttablet_queries_bucket{\n      instance=~\"$host\"\n      }[1m]\n    )\n  )\n",
                   "format": "heatmap",
                   "intervalFactor": 2,
                   "legendFormat": "{{le}}",
                   "refId": "A"
                }
             ],
             "title": "Query Time Distribution (Heatmap)",
             "tooltip": {
                "show": true,
                "showHistogram": false
             },
             "type": "heatmap",
             "xAxis": {
                "show": true
             },
             "xBucketNumber": null,
             "xBucketSize": null,
             "yAxis": {
                "decimals": 0,
                "format": "s",
                "show": true,
                "splitFactor": null
             },
             "yBucketBound": "auto"
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 91
             },
             "id": 47,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "Rows returned",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 12,
                "x": 0,
                "y": 92
             },
             "id": 48,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance,table) (\n  rate(\n    vttablet_query_rows_returned{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}} | {{table}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Rows Returned (by table)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 12,
                "x": 12,
                "y": 92
             },
             "id": 49,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "current",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null as zero",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by (instance,plan) (\n  rate(\n    vttablet_query_rows_returned{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 2,
                   "legendFormat": "{{instance}} | {{plan}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "Rows Returned (by plan)",
             "tooltip": {
                "shared": false,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "collapse": true,
             "collapsed": true,
             "gridPos": {
                "h": 1,
                "w": 24,
                "x": 0,
                "y": 99
             },
             "id": 50,
             "panels": [ ],
             "repeat": null,
             "repeatIteration": null,
             "repeatRowId": null,
             "showTitle": true,
             "title": "GC",
             "titleSize": "h6",
             "type": "row"
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 100
             },
             "id": 51,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": true,
                "min": false,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance)(\n  rate(\n    go_gc_duration_seconds_count{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "GC Count (vttablet)",
             "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "A summary of the pause duration of garbage collection cycles",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 100
             },
             "id": 52,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": true,
                "min": false,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance)(\n  rate(\n    go_gc_duration_seconds_count{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "GC Duration total per second (vttablet)",
             "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 100
             },
             "id": 53,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": true,
                "min": false,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(quantile)(\n  rate(\n    go_gc_duration_seconds{\n      instance=~\"$host\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "p{{quantile}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "GC Duration quantiles (vttablet - all hosts)",
             "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 0,
                "y": 107
             },
             "id": 54,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "max",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance)(\n  rate(\n    go_gc_duration_seconds_count{\n      job=\"vitess-vtgate\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "GC Count (vtgate)",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "ops",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "description": "A summary of the pause duration of garbage collection cycles",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 8,
                "y": 107
             },
             "id": 55,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "max",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(instance)(\n  rate(\n    go_gc_duration_seconds_count{\n      job=\"vitess-vtgate\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "{{instance}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "GC Duration total per second (vtgate)",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          },
          {
             "aliasColors": { },
             "bars": false,
             "dashLength": 10,
             "dashes": false,
             "datasource": "Prometheus",
             "fill": 0,
             "fillGradient": 0,
             "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 107
             },
             "id": 56,
             "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "sideWidth": null,
                "sort": "max",
                "sortDesc": true,
                "total": false,
                "values": true
             },
             "lines": true,
             "linewidth": 1,
             "links": [ ],
             "nullPointMode": "null",
             "percentage": false,
             "pointradius": 5,
             "points": false,
             "renderer": "flot",
             "repeat": null,
             "seriesOverrides": [ ],
             "spaceLength": 10,
             "stack": false,
             "steppedLine": false,
             "targets": [
                {
                   "expr": "sum by(quantile)(\n  rate(\n    go_gc_duration_seconds{\n      job=\"vitess-vtgate\"\n    }[1m]\n  )\n)\n",
                   "format": "time_series",
                   "intervalFactor": 1,
                   "legendFormat": "p{{quantile}}",
                   "refId": "A"
                }
             ],
             "thresholds": [ ],
             "timeFrom": null,
             "timeShift": null,
             "title": "GC Duration quantiles (vtgate)",
             "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
             },
             "type": "graph",
             "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": [ ]
             },
             "yaxes": [
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                },
                {
                   "format": "s",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": 0,
                   "show": true
                }
             ]
          }
       ],
       "refresh": "",
       "rows": [ ],
       "schemaVersion": 14,
       "style": "dark",
       "tags": [
          "vitess-mixin",
          "devview",
          "cluster"
       ],
       "templating": {
          "list": [
             {
                "auto": true,
                "auto_count": 300,
                "auto_min": "1m",
                "current": {
                   "text": "auto",
                   "value": "$__auto_interval"
                },
                "hide": 0,
                "label": "Interval",
                "name": "interval",
                "query": "1m,5m,10m,30m,1h,6h,12h",
                "refresh": 2,
                "type": "interval"
             },
             {
                "allValue": ".*",
                "current": { },
                "datasource": "Prometheus",
                "hide": 0,
                "includeAll": false,
                "label": "Host(s)",
                "multi": true,
                "name": "host",
                "options": [ ],
                "query": "label_values(vttablet_build_number{}, instance)",
                "refresh": 2,
                "regex": "",
                "sort": 1,
                "tagValuesQuery": "",
                "tags": [ ],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
             },
             {
                "allValue": ".*",
                "current": { },
                "datasource": "Prometheus",
                "hide": 0,
                "includeAll": false,
                "label": "Host(s)",
                "multi": true,
                "name": "vtgate_host",
                "options": [ ],
                "query": "label_values(vtgate_build_number, instance)",
                "refresh": 2,
                "regex": "",
                "sort": 0,
                "tagValuesQuery": "",
                "tags": [ ],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
             },
             {
                "allValue": ".*",
                "current": { },
                "datasource": "Prometheus",
                "hide": 0,
                "includeAll": true,
                "label": "Table",
                "multi": false,
                "name": "table",
                "options": [ ],
                "query": "query_result(sum by(table)(vitess_mixin:vtgate_queries_processed_by_table:rate1m{keyspace=\"$keyspace\"}))",
                "refresh": 2,
                "regex": ".*table=\"(.*)\".*",
                "sort": 1,
                "tagValuesQuery": "",
                "tags": [ ],
                "tagsQuery": "",
                "type": "query",
                "useTags": false
             }
          ]
       },
       "time": {
          "from": "now-30m",
          "to": "now"
       },
       "timepicker": {
          "refresh_intervals": [
             "5s",
             "10s",
             "30s",
             "1m",
             "5m",
             "15m",
             "30m",
             "1h",
             "2h",
             "1d"
          ],
          "time_options": [
             "5m",
             "15m",
             "1h",
             "6h",
             "12h",
             "24h",
             "2d",
             "7d",
             "30d"
          ]
       },
       "timezone": "browser",
       "title": "performance overview (auto-generated)",
       "uid": "vitess-performance-overview",
       "version": 0
    }
  prometheus-datasource.yaml: |
    apiVersion: 1
    datasources:
       - name: Prometheus
         type: prometheus
         access: proxy
         url: http://prometheus-service:9090
         isDefault: true
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: wesql-grafana-config
  namespace: default
---
apiVersion: v1
data:
  prometheus.yml: |-
    global:
      scrape_interval: 15s

    rule_files:
      - "prometheus_rules.yaml"

    scrape_configs:
      - job_name: 'vitess-vtgate'
        static_configs:
          - targets: ['wesql-vtgate-headless:15001']

      - job_name: 'vitess-vttablet'
        static_configs:
          - targets: ['mycluster-wesql-headless:15100']

    #  - job_name: 'mysql'
    #    static_configs:
    #      - targets: ['<MySQL_HOST>:<MySQL_PORT>']

        metrics_path: '/metrics'
        scheme: 'http'
  prometheus_rules.yaml: |
    "groups":
      - "name": "vitess_mixin_1"
        "rules":
          - "expr": "sum (rate(vttablet_errors[1m]))"
            "record": "vitess_mixin:vttablet_errors:rate1m"
      - "name": "vitess_mixin_2"
        "rules":
          - "expr": "sum (rate(vttablet_query_counts[1m]))"
            "record": "vitess_mixin:vttablet_query_counts:rate1m"
      - "name": "vitess_mixin_3"
        "rules":
          - "expr": "sum (rate(mysql_global_status_queries[1m]))"
            "record": "vitess_mixin:mysql_global_status_queries:rate1m"
      - "name": "vitess_mixin_4"
        "rules":
          - "expr": "sum by(le)(rate(vtgate_api_bucket[1m]))"
            "record": "vitess_mixin:vtgate_api_bucket:rate1m"
      - "name": "vitess_mixin_5"
        "rules":
          - "expr": "sum by(le,keyspace)(rate(vtgate_api_bucket[1m]))"
            "record": "vitess_mixin:vtgate_api_bucket_by_keyspace:rate1m"
      - "name": "vitess_mixin_6"
        "rules":
          - "expr": "sum (rate(vtgate_api_error_counts[1m]))"
            "record": "vitess_mixin:vtgate_api_error_counts:rate1m"
      - "name": "vitess_mixin_7"
        "rules":
          - "expr": "sum (rate(vtgate_api_count[1m]))"
            "record": "vitess_mixin:vtgate_api_count:rate1m"
      - "name": "vitess_mixin_8"
        "rules":
          - "expr": "sum by(keyspace)(rate(vtgate_api_error_counts[1m]))"
            "record": "vitess_mixin:vtgate_api_error_counts_by_keyspace:rate1m"
      - "name": "vitess_mixin_9"
        "rules":
          - "expr": "sum by(keyspace)(rate(vtgate_api_count[1m]))"
            "record": "vitess_mixin:vtgate_api_count_by_keyspace:rate1m"
      - "name": "vitess_mixin_10"
        "rules":
          - "expr": "sum by (keyspace,shard)(rate(vttablet_kills[1m]))"
            "record": "vitess_mixin:vttablet_kills:rate1m"
      - "name": "vitess_mixin_11"
        "rules":
          - "expr": "sum by(instance)(rate(vtgate_vttablet_call_error_count[1m]))"
            "record": "vitess_mixin:vtgate_vttablet_call_error_count_byinstance:rate1m"
      - "name": "vitess_mixin_12"
        "rules":
          - "expr": "sum by(db_type)(rate(vtgate_api_error_counts[1m]))"
            "record": "vitess_mixin:vtgate_api_error_counts_by_db_type:rate1m"
      - "name": "vitess_mixin_13"
        "rules":
          - "expr": "sum by(db_type)(rate(vtgate_api_count[1m]))"
            "record": "vitess_mixin:vtgate_api_count_by_db_type:rate1m"
      - "name": "vitess_mixin_14"
        "rules":
          - "expr": "sum by(le,db_type)(rate(vtgate_api_bucket[1m]))"
            "record": "vitess_mixin:vtgate_api_bucket_by_db_type:rate1m"
      - "name": "vitess_mixin_15"
        "rules":
          - "expr": "sum by(operation)(rate(vtgate_api_error_counts[1m]))"
            "record": "vitess_mixin:vtgate_api_error_counts_by_operation:rate1m"
      - "name": "vitess_mixin_16"
        "rules":
          - "expr": "sum by(code)(rate(vtgate_api_error_counts[1m]))"
            "record": "vitess_mixin:vtgate_api_error_counts_by_code:rate1m"
      - "name": "vitess_mixin_17"
        "rules":
          - "expr": "sum by(keyspace,shard)(rate(vttablet_queries_sum[1m]))"
            "record": "vitess_mixin:vttablet_queries_sum_by_keyspace_shard:rate1m"
      - "name": "vitess_mixin_18"
        "rules":
          - "expr": "sum by(keyspace,shard)(rate(vttablet_queries_count[1m]))"
            "record": "vitess_mixin:vttablet_queries_count_by_keyspace_shard:rate1m"
      - "name": "vitess_mixin_19"
        "rules":
          - "expr": "sum by(keyspace,shard,le)(rate(vttablet_transactions_bucket[1m]))"
            "record": "vitess_mixin:vttablet_transactions_bucket_by_keyspace_shard:rate1m"
      - "name": "vitess_mixin_20"
        "rules":
          - "expr": "sum by (instance,job) (changes (process_start_time_seconds[5m]))"
            "record": "vitess_mixin:process_start_time_seconds_by_instance_job:sum5m"
      - "name": "vitess_mixin_21"
        "rules":
          - "expr": "sum by(instance)(rate(vttablet_kills[1m]))"
            "record": "vitess_mixin:vttablet_kills_by_instance:rate1m"
      - "name": "vitess_mixin_22"
        "rules":
          - "expr": "sum by(keyspace,shard,instance,error_code)(rate(vttablet_errors[1m]))"
            "record": "vitess_mixin:vttablet_errors:rate1m"
      - "name": "vitess_mixin_23"
        "rules":
          - "expr": "sum by(keyspace,plan,table) (rate(vtgate_queries_processed_by_table{plan!=\"Rollback\"}[1m]))"
            "record": "vitess_mixin:vtgate_queries_processed_by_table:rate1m"
      - "name": "vitess_mixin_24"
        "rules":
          - "expr": "sum by(le)(rate(vttablet_queries_bucket[1m]))"
            "record": "vitess_mixin:vttablet_queries_bucket:rate1m"
      - "name": "vitess_mixin_25"
        "rules":
          - "expr": "sum by(keyspace, table) (rate(vttablet_query_counts{plan!=\"Rollback\"}[1m]))"
            "record": "vitess_mixin:vttablet_query_counts_by_keyspace_table:rate1m"
      - "name": "vitess_mixin_26"
        "rules":
          - "expr": "sum by(le)(rate(vttablet_mysql_bucket[1m]))"
            "record": "vitess_mixin:vttablet_mysql_bucket:rate1m"
      - "name": "vitess_mixin_27"
        "rules":
          - "expr": "sum({__name__=~'vttablet_.*_active'})"
            "record": "vitess_mixin:vttablet_connections_active:rate1m"
      - "name": "vitess_mixin_28"
        "rules":
          - "expr": "sum({__name__=~'vttablet_.*_in_use'})"
            "record": "vitess_mixin:vttablet_connections_in_use:rate1m"
      - "name": "vitess_mixin_29"
        "rules":
          - "expr": "sum({__name__=~'vttablet_.*_capacity'})"
            "record": "vitess_mixin:vttablet_connections_capacity:rate1m"
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: wesql-prometheus-config
  namespace: default
---
apiVersion: v1
kind: Service
metadata:
  name: grafana-service
  namespace: default
spec:
  ports:
  - port: 3000
    protocol: TCP
    targetPort: 3000
  selector:
    app: grafana
---
apiVersion: v1
kind: Service
metadata:
  name: prometheus-service
  namespace: default
spec:
  ports:
  - port: 9090
    protocol: TCP
    targetPort: 9090
  selector:
    app: prometheus
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: grafana
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: grafana
  template:
    metadata:
      labels:
        app: grafana
    spec:
      containers:
      - env:
        - name: GF_AUTH_ANONYMOUS_ENABLED
          value: "true"
        - name: GF_AUTH_ANONYMOUS_ORG_ROLE
          value: Admin
        - name: GF_AUTH_DISABLE_LOGIN_FORM
          value: "true"
        image: grafana/grafana
        name: grafana
        ports:
        - containerPort: 3000
        volumeMounts:
        - mountPath: /etc/grafana/provisioning/datasources/
          name: datasource-volume
        - mountPath: /etc/grafana/provisioning/dashboards/
          name: dashboard-volume
      volumes:
      - configMap:
          items:
          - key: prometheus-datasource.yaml
            path: prometheus-datasource.yaml
          name: wesql-grafana-config
        name: datasource-volume
      - configMap:
          items:
          - key: dashboards.yaml
            path: dashboards.yaml
          - key: performance_overview.json
            path: performance_overview.json
          name: wesql-grafana-config
        name: dashboard-volume
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: prometheus
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: prometheus
  template:
    metadata:
      labels:
        app: prometheus
    spec:
      containers:
      - args:
        - --config.file=/etc/prometheus/prometheus.yml
        - --web.enable-lifecycle
        image: prom/prometheus
        name: prometheus
        ports:
        - containerPort: 9090
        volumeMounts:
        - mountPath: /etc/prometheus/
          name: config-volume
      volumes:
      - configMap:
          name: wesql-prometheus-config
        name: config-volume
